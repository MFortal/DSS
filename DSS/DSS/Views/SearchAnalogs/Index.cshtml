@using DSS.Common
@model DSS.Models.Component

@{
    ViewBag.Title = DefaultNames.SearchAnalogs;
}

<h2>@DefaultNames.SearchAnalogs</h2>

<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

@*@Scripts.Render("~/scripts/jquery-3.3.1.js")*@

<div class="flex-nlg">
    <div class="flex-itm-nlg">
        <p>Аналогом является компонент, удовлетворяющий условиям: </p>
    </div>
    <div class="flex-itm-nlg">
        <ul>
            <li>компонент, <strong>произведен в России</strong></li>
            <li>компонент, находится <strong>в той же подкатегории</strong></li>
            <li>свойства, отличаются не более, чем на <strong>@ViewBag.CountVariance позиции</strong></li>
            <li>не указанные свойства являются <strong>совпадающими</strong></li>
        </ul>
    </div>
    <div class="flex-itm-nlg search">
        @using (Ajax.BeginForm("ShowResult", "SearchAnalogs", new AjaxOptions { UpdateTargetId = "results" }))
        {
            @Html.AntiForgeryToken()

            <div class="flex-fld">
                <div class="flex-fld-itm">
                    @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control", placeholder = "Наименование компонента" } })
                </div>
                <div class="flex-fld-itm">
                    <input class="btn btn-success" type="submit" value="Поиск" />
                </div>
            </div>
        }
    </div>

    <table class="table" id="results"></table>

</div>


@*<script src="https://ajax.aspnetcdn.com/ajax/jquery/jquery-1.8.0.js"></script>*@
@*<script src="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.8.22/jquery-ui.js"></script>*@


<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.3.1.js"></script>
<script src="https://ajax.aspnetcdn.com/ajax/jquery.ui/1.10.4/jquery-ui.js"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $("#Name").autocomplete({
            source: function (request, response) {
                $.ajax({
                    url: "/SearchAnalogs/Index",
                    type: "POST",
                    dataType: "json",
                    data: { prefix: request.term },
                    success: function (data) {
                        response($.map(data, function (item) {
                            return { label: item.Name, value: item.Id };
                        }));
                    }
                });
            },
            messages: {
                noResults: "", results: ""
            }
        });
    })
</script>

@Scripts.Render("~/scripts/jquery.unobtrusive-ajax.js")